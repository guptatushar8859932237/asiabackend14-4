"use strict";(self.webpackChunkasia_direct=self.webpackChunkasia_direct||[]).push([[480],{4480:(e,t,s)=>{s.r(t),s.d(t,{default:()=>u});var a=s(7154),l=s(5043),i=s(1434),c=s(7503),n=s(64),d=s.n(n),r=s(5572),o=s(4802),m=s(5704),h=s(579);const u=()=>{const[e,t]=(0,l.useState)([]),[s,n]=(0,l.useState)({send_to:"",user_id:"",title:"",description:""}),[u,x]=(0,l.useState)(!1),[p,j]=(0,l.useState)(!1),[b,v]=(0,l.useState)(!1),[f,g]=(0,l.useState)(!1),[N,_]=(0,l.useState)(""),[S,y]=(0,l.useState)([]),[C,A]=(0,l.useState)([]),[B,k]=(0,l.useState)([]),[w,M]=(0,l.useState)([]),[R,P]=(0,l.useState)([]),[U,I]=(0,l.useState)(1),[T,q]=(0,l.useState)({}),D=((0,l.useRef)(),(0,l.useRef)()),E=(0,l.useRef)(),F=(0,l.useRef)(),L=()=>{a.A.post("".concat("https://sisccltd.com/api/","notification-list")).then((e=>{t(e.data.data)}))},Y=e=>{const{name:t,value:l}=e.target;n({...s,[t]:l}),"send_to"===t&&(x("4"===l),j("3"===l),v("5"===l),g("6"===l),"3"!==l&&"5"!==l&&"6"!==l||a.A.get("".concat("https://sisccltd.com/api/","clientlist")).then((e=>{y(e.data.data)})),"4"===l&&a.A.get("".concat("https://sisccltd.com/api/","staff-list")).then((e=>{A(e.data.data)})),"6"===l&&a.A.get("".concat("https://sisccltd.com/api/","getBatchList")).then((e=>{k(e.data.data)})))},G=()=>{const e={send_to:s.send_to,batch_id:parseInt(N),user_id:s.user_id,title:s.title,description:s.description};a.A.post("".concat("https://sisccltd.com/api/","send-notification"),e).then((e=>{c.oR.success(e.data.message);const t=document.getElementById("exampleModal");m.aF.getOrCreateInstance(t).hide(),setTimeout((()=>{document.querySelectorAll(".modal-backdrop").forEach((e=>e.remove())),document.body.classList.remove("modal-open"),document.body.style=""}),300),D.current&&(D.current.value=""),E.current&&(E.current.value=""),n({send_to:"",user_id:"",title:"",description:""}),P([]),x(!1),j(!1),v(!1),g(!1),_(""),M([]),L(),F.current&&(F.current.value="")})).catch((e=>{e.response?c.oR.error("Error: ".concat(e.response.data.message||"Server error")):c.oR.error("Network or request error.")}))},O=e=>{I(e)};(0,l.useEffect)((()=>{L(),a.A.get("".concat("https://sisccltd.com/api/","getAllBatch")).then((e=>{e.data.success&&k(e.data.data)}))}),[]);const W=Math.ceil(e.length/10),z=10*(U-1),H=e.slice(z,z+10);return(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"wpWrapper",children:[(0,h.jsxs)("div",{className:"container-fluid",children:[(0,h.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[(0,h.jsx)("h4",{children:"Notification"}),(0,h.jsx)("button",{"data-bs-toggle":"modal","data-bs-target":"#exampleModal",className:"btn btn-primary",children:"Send Notification"})]}),(0,h.jsx)("div",{className:"modal fade",id:"exampleModal",tabIndex:"-1",children:(0,h.jsx)("div",{className:"modal-dialog modal-dialog-centered",children:(0,h.jsxs)("div",{className:"modal-content",children:[(0,h.jsxs)("div",{className:"modal-header",children:[(0,h.jsx)("h5",{className:"modal-title",children:"Add Notification"}),(0,h.jsx)("button",{className:"btn-close","data-bs-dismiss":"modal",children:(0,h.jsx)(o.A,{})})]}),(0,h.jsxs)("div",{className:"modal-body",children:[(0,h.jsx)("div",{className:"d-flex flex-wrap gap-3 mb-3",children:[{label:"All User",value:"2"},{label:"All Staff",value:"1"},{label:"Particular User",value:"3"},{label:"Particular Staff",value:"4"},{label:"Multiple Users",value:"5"},{label:"Users by Batch",value:"6"}].map((e=>(0,h.jsxs)("label",{children:[(0,h.jsx)("input",{type:"radio",value:e.value,name:"send_to",onChange:Y})," ",e.label]},e.value)))}),p&&(0,h.jsxs)("div",{className:"mb-3",children:[(0,h.jsx)("label",{children:"Particular User"}),(0,h.jsxs)("select",{name:"user_id",className:"form-control",onChange:Y,children:[(0,h.jsx)("option",{value:"",children:"Select..."}),S.map((e=>(0,h.jsx)("option",{value:e.id,children:e.client_name},e.id)))]})]}),u&&(0,h.jsxs)("div",{className:"mb-3",children:[(0,h.jsx)("label",{children:"Particular Staff"}),(0,h.jsxs)("select",{name:"user_id",className:"form-control",onChange:Y,children:[(0,h.jsx)("option",{value:"",children:"Select..."}),C.map((e=>(0,h.jsx)("option",{value:e.id,children:e.full_name},e.id)))]})]}),b&&(0,h.jsxs)("div",{className:"mb-3",children:[(0,h.jsx)("label",{children:"Multiple Users"}),(0,h.jsx)(r.Ay,{isMulti:!0,options:S.map((e=>({value:e.id,label:e.client_name}))),classNamePrefix:"select",onChange:e=>{const t=e.map((e=>e.value));P(t),n({...s,user_id:t.join(",")})},value:S.filter((e=>R.includes(e.id))).map((e=>({value:e.id,label:e.client_name})))})]}),f&&(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"mb-3",children:[(0,h.jsx)("label",{children:"Select Batch"}),(0,h.jsxs)("select",{className:"form-control",onChange:e=>{const t=e.target.value;_(t),t?a.A.post("".concat("https://sisccltd.com/api/","getClientByBatchId"),{batch_id:t}).then((e=>{M(e.data.data);const t=e.data.data.map((e=>e.id)).join(",");n({...s,user_id:t})})).catch((e=>{console.log("i")})):(M([]),n({...s,user_id:""}))},children:[(0,h.jsx)("option",{value:"",children:"Select Batch"}),B.map((e=>(0,h.jsx)("option",{value:e.id,children:e.batch_number},e.id)))]})]})}),(0,h.jsxs)("div",{className:"mb-3",children:[(0,h.jsx)("label",{children:"Title"}),(0,h.jsx)("input",{type:"text",name:"title",className:"form-control",onChange:Y,ref:D}),(0,h.jsx)("p",{className:"text-danger",children:T.title})]}),(0,h.jsxs)("div",{className:"mb-3",children:[(0,h.jsx)("label",{children:"Message"}),(0,h.jsx)("textarea",{name:"description",className:"form-control",onChange:Y,ref:E}),(0,h.jsx)("p",{className:"text-danger",children:T.description})]})]}),(0,h.jsx)("div",{className:"modal-footer",children:(0,h.jsx)("button",{onClick:()=>{(e=>{let t={};e.title||(t.title="Title is required"),e.description||(t.description="Description is required"),t.title||t.description||G(),q(t)})(s)},className:"btn btn-primary",children:"Send Notification"})})]})})}),(0,h.jsxs)("div",{className:"table-responsive mt-2",children:[(0,h.jsxs)("table",{className:"table table-striped",children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{children:"Sr.No."}),(0,h.jsx)("th",{children:"Title"}),(0,h.jsx)("th",{children:"Message"}),(0,h.jsx)("th",{children:"Date"}),(0,h.jsx)("th",{children:"Action"})]})}),(0,h.jsx)("tbody",{children:H.map(((e,t)=>{const s=new Date(null===e||void 0===e?void 0:e.created_at).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"});return(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:z+t+1}),(0,h.jsx)("td",{children:e.title}),(0,h.jsx)("td",{children:e.description}),(0,h.jsx)("td",{children:s}),(0,h.jsx)("td",{children:(0,h.jsx)(i.F23,{className:"text-danger",style:{cursor:"pointer"},onClick:()=>{return t=e.id,void d().fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then((e=>{e.isConfirmed&&a.A.post("".concat("https://sisccltd.com/api/","delete-notification"),{notification_id:t}).then((e=>{c.oR.success(e.data.message),L()})).catch((e=>{c.oR.error(e.response.data.message)}))}));var t}})})]},e.id)}))})]}),(0,h.jsxs)("div",{className:"d-flex justify-content-end align-items-center",children:[(0,h.jsx)("button",{disabled:1===U,onClick:()=>O(U-1),className:"bg_page",children:"<"}),(0,h.jsx)("span",{className:"mx-2",children:"Page ".concat(U," of ").concat(W)}),(0,h.jsx)("button",{disabled:U===W,onClick:()=>O(U+1),className:"bg_page",children:">"})]})]})]}),(0,h.jsx)(c.N9,{})]})})}}}]);
//# sourceMappingURL=480.1ce7c9a9.chunk.js.map